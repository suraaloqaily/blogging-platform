(()=>{var e={};e.id=888,e.ids=[888],e.modules={4410:(e,t,r)=>{"use strict";r.d(t,{H:()=>c,a:()=>l});var o=r(6689),s=r(1163),n=r(3053),i=r(997);let a=(0,o.createContext)(),c=({children:e})=>{let{0:t,1:r}=(0,o.useState)(null),{0:c,1:l}=(0,o.useState)(!0),u=(0,s.useRouter)(),p=async()=>{try{let e=(0,n.parseCookies)();if(!e.token){r(null),l(!1);return}let t=await fetch("http://localhost:5000/auth/session",{headers:{Authorization:`Bearer ${e.token}`},credentials:"include"});if(t.ok){let e=await t.json();r(e.user)}else(0,n.destroyCookie)(null,"token"),r(null)}catch(e){console.error("Check user error:",e),(0,n.destroyCookie)(null,"token"),r(null)}finally{l(!1)}};(0,o.useEffect)(()=>{p()},[]);let f=async e=>{try{let t=await fetch("http://localhost:5000/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)}),o=await t.json();if(t.ok&&o.token)return(0,n.setCookie)(null,"token",o.token,{maxAge:2592e3,path:"/",secure:!0,sameSite:"lax"}),r(o.user),u.push("/blogging-platform/homepage"),{success:!0};return{success:!1,message:o.message}}catch(e){return console.error("Login error:",e),{success:!1,message:"Login failed"}}},g=async()=>{try{await fetch("http://localhost:5000/auth/logout",{method:"POST",credentials:"include"})}catch(e){console.error("Logout error:",e)}finally{(0,n.destroyCookie)(null,"token"),r(null),u.push("/login")}},h=async e=>{try{let t=(0,n.parseCookies)(),o=await fetch("http://localhost:5000/user/update",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.token}`},credentials:"include",body:JSON.stringify(e)}),s=await o.json();if(o.ok)return r(s.user),s.token&&(0,n.setCookie)(null,"token",s.token,{maxAge:2592e3,path:"/",secure:!0,sameSite:"strict"}),{success:!0,message:"Profile updated successfully"};return{success:!1,message:s.message||"Update failed"}}catch(e){return console.error("Profile update error:",e),{success:!1,message:"An error occurred while updating profile"}}};return(0,i.jsx)(a.Provider,{value:{user:t,login:f,logout:g,loading:c,updateUser:h},children:e})},l=()=>(0,o.useContext)(a)},4008:(e,t,r)=>{"use strict";r.d(t,{L:()=>u,U:()=>p});var o=r(6689),s=r(1163),n=r(4410),i=r(997);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach(function(t){var o,s;o=t,s=r[t],(o=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(o))in e?Object.defineProperty(e,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[o]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let l=(0,o.createContext)(),u=({children:e})=>{let{0:t,1:r}=(0,o.useState)([]),a=(0,s.useRouter)(),{user:u}=(0,n.a)(),p=async()=>{try{let e=await fetch("http://localhost:5000/blogs",{credentials:"include"});if(e.ok){let t=await e.json();r(t)}else r([])}catch(e){console.error("Fetch blogs error:",e)}};(0,o.useEffect)(()=>{!(a.pathname.includes("/login")||a.pathname.includes("/register"))&&u&&p()},[u,a.pathname]);let f=async e=>{try{let o=await fetch("http://localhost:5000/blogs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(o.ok){let e=await o.json();return r([...t,e]),{success:!0}}}catch(e){return console.error("Create blog error:",e),{success:!1}}},g=async(e,o)=>{try{let s=await fetch(`http://localhost:5000/blogs/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)});if(s.ok){let o=await s.json();return r(t.map(t=>t.id===e?o:t)),{success:!0}}}catch(e){return console.error("Update blog error:",e),{success:!1}}},h=async e=>{try{if((await fetch(`http://localhost:5000/blogs/${e}`,{method:"DELETE",credentials:"include"})).ok)return r(t=>t.filter(t=>t.id!==e)),{success:!0}}catch(e){return console.error("Delete blog error:",e),{success:!1}}};return(0,i.jsx)(l.Provider,{value:{blogs:t,createBlog:f,updateBlog:g,deleteBlog:h,updateBlogLikes:(e,t,o)=>{r(r=>Array.isArray(r)?r.map(r=>r.id===e?c(c({},r),{},{likeCount:t,isLiked:o}):r):(console.error("prevBlogs is not an array:",r),[]))},updateBlogComments:(e,t)=>{r(r=>r.map(r=>r.id===e?c(c({},r),{},{comments:t}):r))}},children:e})},p=()=>(0,o.useContext)(l)},5118:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var o=r(4410),s=r(4008),n=r(1163),i=r(3053),a=r(6689);r(108);var c=r(997);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){var o,s;o=t,s=r[t],(o=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(o))in e?Object.defineProperty(e,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[o]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function p({Component:e,pageProps:t}){let r=(0,n.useRouter)(),l=["/blogging-platform/login","/blogging-platform/register"].includes(r.pathname);return(0,a.useEffect)(()=>{let e=!!(0,i.parseCookies)().token;if(console.log(e,"isAuthenticated"),console.log(l,"isAuthRoute"),console.log(r.pathname,"router.pathname"),e&&l){r.push("/blogging-platform/homepage");return}if(!e&&!l&&"/"!==r.pathname){r.push("/blogging-platform/login");return}},[r.pathname,l,r]),(0,c.jsx)(o.H,{children:l?(0,c.jsx)(e,u({},t)):(0,c.jsx)(s.L,{children:(0,c.jsx)(e,u({},t))})})}p.getInitialProps=async({Component:e,ctx:t})=>{let r={},o=!!(0,i.parseCookies)(t).token;return e.getInitialProps&&(r=await e.getInitialProps(t)),{pageProps:r,isAuthenticated:o}}},108:()=>{},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},3053:e=>{"use strict";e.exports=require("nookies")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[202,163],()=>r(5118));module.exports=o})();
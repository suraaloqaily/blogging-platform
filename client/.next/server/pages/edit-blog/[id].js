(()=>{var e={};e.id=905,e.ids=[905,660,888],e.modules={3961:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(8219),o=r.n(s),n=r(997);let a=()=>(0,n.jsx)("div",{className:o().loadingContainer,children:(0,n.jsx)("div",{className:o().spinner})})},4410:(e,t,r)=>{"use strict";r.d(t,{H:()=>l,a:()=>c});var s=r(6689),o=r(1163),n=r(3053),a=r(997);let i=(0,s.createContext)(),l=({children:e})=>{let{0:t,1:r}=(0,s.useState)(null),{0:l,1:c}=(0,s.useState)(!0),u=(0,o.useRouter)(),d=async()=>{try{let e=(0,n.parseCookies)();if(!e.token){r(null),c(!1);return}let t=await fetch("http://localhost:5000/auth/session",{headers:{Authorization:`Bearer ${e.token}`},credentials:"include"});if(t.ok){let e=await t.json();r(e.user)}else(0,n.destroyCookie)(null,"token"),r(null)}catch(e){console.error("Check user error:",e),(0,n.destroyCookie)(null,"token"),r(null)}finally{c(!1)}};(0,s.useEffect)(()=>{d()},[]);let h=async e=>{try{let t=await fetch("http://localhost:5000/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)}),s=await t.json();if(t.ok&&s.token)return(0,n.setCookie)(null,"token",s.token,{maxAge:2592e3,path:"/",secure:!0,sameSite:"lax"}),r(s.user),u.push("/homepage"),{success:!0};return{success:!1,message:s.message}}catch(e){return console.error("Login error:",e),{success:!1,message:"Login failed"}}},g=async()=>{try{await fetch("http://localhost:5000/auth/logout",{method:"POST",credentials:"include"})}catch(e){console.error("Logout error:",e)}finally{(0,n.destroyCookie)(null,"token"),r(null),u.push("/login")}},p=async e=>{try{let t=(0,n.parseCookies)(),s=await fetch("http://localhost:5000/user/update",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.token}`},credentials:"include",body:JSON.stringify(e)}),o=await s.json();if(s.ok)return r(o.user),o.token&&(0,n.setCookie)(null,"token",o.token,{maxAge:2592e3,path:"/",secure:!0,sameSite:"strict"}),{success:!0,message:"Profile updated successfully"};return{success:!1,message:o.message||"Update failed"}}catch(e){return console.error("Profile update error:",e),{success:!1,message:"An error occurred while updating profile"}}};return(0,a.jsx)(i.Provider,{value:{user:t,login:h,logout:g,loading:l,updateUser:p},children:e})},c=()=>(0,s.useContext)(i)},4008:(e,t,r)=>{"use strict";r.d(t,{L:()=>u,U:()=>d});var s=r(6689),o=r(1163),n=r(4410),a=r(997);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){var s,o;s=t,o=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s))in e?Object.defineProperty(e,s,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[s]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let c=(0,s.createContext)(),u=({children:e})=>{let{0:t,1:r}=(0,s.useState)([]),i=(0,o.useRouter)(),{user:u}=(0,n.a)(),d=async()=>{try{let e=await fetch("http://localhost:5000/blogs",{credentials:"include"});if(e.ok){let t=await e.json();r(t)}else r([])}catch(e){console.error("Fetch blogs error:",e)}};(0,s.useEffect)(()=>{!(i.pathname.includes("/login")||i.pathname.includes("/register"))&&u&&d()},[u,i.pathname]);let h=async e=>{try{let s=await fetch("http://localhost:5000/blogs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(s.ok){let e=await s.json();return r([...t,e]),{success:!0}}}catch(e){return console.error("Create blog error:",e),{success:!1}}},g=async(e,s)=>{try{let o=await fetch(`http://localhost:5000/blogs/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)});if(o.ok){let s=await o.json();return r(t.map(t=>t.id===e?s:t)),{success:!0}}}catch(e){return console.error("Update blog error:",e),{success:!1}}},p=async e=>{try{if((await fetch(`http://localhost:5000/blogs/${e}`,{method:"DELETE",credentials:"include"})).ok)return r(t=>t.filter(t=>t.id!==e)),{success:!0}}catch(e){return console.error("Delete blog error:",e),{success:!1}}};return(0,a.jsx)(c.Provider,{value:{blogs:t,createBlog:h,updateBlog:g,deleteBlog:p,updateBlogLikes:(e,t,s)=>{r(r=>Array.isArray(r)?r.map(r=>r.id===e?l(l({},r),{},{likeCount:t,isLiked:s}):r):(console.error("prevBlogs is not an array:",r),[]))},updateBlogComments:(e,t)=>{r(r=>r.map(r=>r.id===e?l(l({},r),{},{comments:t}):r))}},children:e})},d=()=>(0,s.useContext)(c)},5118:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(4410),o=r(4008),n=r(1163),a=r(3053),i=r(6689);r(108);var l=r(997);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){var s,o;s=t,o=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s))in e?Object.defineProperty(e,s,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[s]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d({Component:e,pageProps:t}){let r=(0,n.useRouter)(),c=["/login","/register"].includes(r.pathname);return(0,i.useEffect)(()=>{let e=!!(0,a.parseCookies)().token;if(console.log(e,"isAuthenticated"),console.log(c,"isAuthRoute"),console.log(r.pathname,"router.pathname"),e&&c){r.push("/homepage");return}if(!e&&!c&&"/"!==r.pathname){r.push("/login");return}},[r.pathname,c,r]),(0,l.jsx)(s.H,{children:c?(0,l.jsx)(e,u({},t)):(0,l.jsx)(o.L,{children:(0,l.jsx)(e,u({},t))})})}d.getInitialProps=async({Component:e,ctx:t})=>{let r={},s=!!(0,a.parseCookies)(t).token;return e.getInitialProps&&(r=await e.getInitialProps(t)),{pageProps:r,isAuthenticated:s}}},5571:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var s=r(6859),o=r(997);function n(){return(0,o.jsxs)(s.Html,{lang:"en",children:[(0,o.jsx)(s.Head,{}),(0,o.jsxs)("body",{className:"antialiased",children:[(0,o.jsx)(s.Main,{}),(0,o.jsx)(s.NextScript,{})]})]})}},5846:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});class s{constructor(){if(s.instance)return s.instance;this.baseUrl="http://localhost:5000/blogs",s.instance=this}async fetchComments(e){try{let t=await fetch(`${this.baseUrl}/${e}/comments`,{credentials:"include"});if(!t.ok)throw Error("Failed to fetch comments");return t.json()}catch(e){return{success:!1,message:"Unable to load comments. Please try again later."}}}async checkIfLiked(e){try{let t=await fetch(`${this.baseUrl}/${e}/check-like`,{credentials:"include"});if(!t.ok)throw Error("Failed to check like status");return t.json()}catch(e){return{success:!1,message:"Unable to check like status. Please try again later."}}}async likeBlog(e){try{let t=await fetch(`${this.baseUrl}/${e}/like`,{method:"POST",credentials:"include"});if(!t.ok)throw Error("Failed to like blog");return t.json()}catch(e){return{success:!1,message:"Unable to like the blog. Please try again later."}}}async deleteBlog(e){try{let t=await fetch(`${this.baseUrl}/${e}`,{method:"DELETE",credentials:"include"});if(!t.ok)throw Error("Failed to delete blog");return t.json()}catch(e){return{success:!1,message:"Unable to delete the blog. Please try again later."}}}async addComment(e,t){try{let r=await fetch(`${this.baseUrl}/${e}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({content:t})});if(!r.ok)throw Error("Failed to add comment");return r.json()}catch(e){return{success:!1,message:"Unable to add comment. Please try again later."}}}async fetchBlogDetails(e){try{let t=await fetch(`${this.baseUrl}/blog_id/${e}`,{credentials:"include"});if(!t.ok){if(404===t.status)return{success:!1,message:"Blog not found"};throw Error("Failed to fetch blog")}let r=await t.json(),[s,o]=await Promise.all([this.fetchComments(e),this.checkIfLiked(e)]);return{success:!0,blog:r,comments:s,liked:o.liked,likeCount:o.like_count}}catch(e){return{success:!1,message:"Unable to load blog details. Please try again later."}}}}let o=new s},1323:(e,t)=>{"use strict";Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},4609:e=>{e.exports={modalContent:"BlogDetails_modalContent__OVMbs",closeButton:"BlogDetails_closeButton__JySAz",blogContent:"BlogDetails_blogContent__MnvkQ",blogHeader:"BlogDetails_blogHeader__ldH5g",title:"BlogDetails_title__bnMI0",metadata:"BlogDetails_metadata__XENsh",content:"BlogDetails_content__LH86_",interactions:"BlogDetails_interactions__v6zJ0",likeButton:"BlogDetails_likeButton__JNCWp",commentsSection:"BlogDetails_commentsSection__2LO46",commentForm:"BlogDetails_commentForm__vNcVS",commentInput:"BlogDetails_commentInput__LocND",submit:"BlogDetails_submit__8fp62",commentsList:"BlogDetails_commentsList__h8CSv",comment:"BlogDetails_comment__QZUBq",commentHeader:"BlogDetails_commentHeader__wyA0B",commentAuthor:"BlogDetails_commentAuthor__6Oi9Z",commentDate:"BlogDetails_commentDate__7bX1A",popup:"BlogDetails_popup__iAEyM"}},288:e=>{e.exports={container:"EditBlog_container__3JzRT",title:"EditBlog_title__lTLoJ",form:"EditBlog_form__gDT5d",input:"EditBlog_input__IbFBs",textarea:"EditBlog_textarea__kaXv6",buttons:"EditBlog_buttons__sC0r0",submitButton:"EditBlog_submitButton__TduPE",cancelButton:"EditBlog_cancelButton__NJQBc"}},8219:e=>{e.exports={loadingContainer:"Loading_loadingContainer__s3hPe",spinner:"Loading_spinner__uD5wj",spin:"Loading_spin__p6qET"}},5359:(e,t,r)=>{"use strict";r.r(t),r.d(t,{config:()=>B,default:()=>v,getServerSideProps:()=>S,getStaticPaths:()=>x,getStaticProps:()=>k,reportWebVitals:()=>w,routeModule:()=>N,unstable_getServerProps:()=>D,unstable_getServerSideProps:()=>A,unstable_getStaticParams:()=>C,unstable_getStaticPaths:()=>E,unstable_getStaticProps:()=>O});var s={};r.r(s),r.d(s,{default:()=>P});var o=r(5872),n=r(3593),a=r(1323),i=r(5571),l=r(5118),c=r(6689),u=r(1163),d=r(4008),h=r(4410),g=r(288),p=r.n(g),m=r(997);let f=({blog:e})=>{let t=(0,u.useRouter)(),{id:r}=t.query,{updateBlog:s}=(0,d.U)(),{user:o}=(0,h.a)(),{0:n,1:a}=(0,c.useState)(e.title),{0:i,1:l}=(0,c.useState)(e.content);(0,c.useEffect)(()=>{e&&o&&e.user_id!==o.id&&t.push("/homepage")},[e,o,t]);let g=async e=>{e.preventDefault();try{await s(r,{title:n,content:i}),t.push("/homepage")}catch(e){console.error("Error updating blog:",e)}};return(0,m.jsx)("div",{className:p().container,children:(0,m.jsxs)("form",{onSubmit:g,className:p().form,children:[(0,m.jsx)("input",{type:"text",value:n,onChange:e=>a(e.target.value),placeholder:"Blog title",className:p().input}),(0,m.jsx)("textarea",{value:i,onChange:e=>l(e.target.value),placeholder:"Blog content",className:p().textarea,rows:"10"}),(0,m.jsxs)("div",{className:p().buttons,children:[(0,m.jsx)("button",{type:"submit",className:p().submitButton,children:"Save Changes"}),(0,m.jsx)("button",{type:"button",onClick:()=>t.push("/homepage"),className:p().cancelButton,children:"Cancel"})]})]})})};var b=r(3961),y=r(4609),_=r.n(y),j=r(5846);let P=()=>{let e=(0,u.useRouter)(),{id:t}=e.query,{0:r,1:s}=(0,c.useState)(null),{0:o,1:n}=(0,c.useState)(!0),{0:a,1:i}=(0,c.useState)(null);return((0,c.useEffect)(()=>{(async()=>{if(t){n(!0),i(null);try{let e=await j.Z.fetchBlogDetails(t);s(e.blog)}catch(t){console.error("Error fetching blog details:",t),i("Failed to load blog details. Redirecting to homepage..."),setTimeout(()=>{e.push("/homepage")},1e3)}finally{n(!1)}}})()},[t,e]),o)?(0,m.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,m.jsx)(b.Z,{})}):a?(0,m.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,m.jsx)("h2",{children:a})}):r?(0,m.jsx)("div",{className:"blog-detail-page",children:(0,m.jsxs)("div",{className:_().modalContent,children:[(0,m.jsxs)("div",{className:_().header,children:[(0,m.jsxs)("div",{className:_().blogHeader,children:[(0,m.jsx)("h1",{className:_().title,children:r.title})," "]}),(0,m.jsx)("button",{className:_().closeButton,onClick:()=>{e.push("/homepage")},children:"\xd7"})]}),(0,m.jsx)(f,{blog:r})]})}):(0,m.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:"Blog not found"})},v=(0,a.l)(s,"default"),k=(0,a.l)(s,"getStaticProps"),x=(0,a.l)(s,"getStaticPaths"),S=(0,a.l)(s,"getServerSideProps"),B=(0,a.l)(s,"config"),w=(0,a.l)(s,"reportWebVitals"),O=(0,a.l)(s,"unstable_getStaticProps"),E=(0,a.l)(s,"unstable_getStaticPaths"),C=(0,a.l)(s,"unstable_getStaticParams"),D=(0,a.l)(s,"unstable_getServerProps"),A=(0,a.l)(s,"unstable_getServerSideProps"),N=new o.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/edit-blog/[id]",pathname:"/edit-blog/[id]",bundlePath:"",filename:""},components:{App:l.default,Document:i.default},userland:s})},108:()=>{},3593:(e,t)=>{"use strict";var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE"}(r||(r={}))},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},3053:e=>{"use strict";e.exports=require("nookies")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[202,163,859],()=>r(5359));module.exports=s})();
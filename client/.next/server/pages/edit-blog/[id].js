(()=>{var e={};e.id=905,e.ids=[905,888,660],e.modules={3961:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var o=r(8219),s=r.n(o),n=r(997);let a=()=>(0,n.jsx)("div",{className:s().loadingContainer,children:(0,n.jsx)("div",{className:s().spinner})})},4410:(e,t,r)=>{"use strict";r.d(t,{H:()=>i,a:()=>c});var o=r(6689),s=r(1163),n=r(3053),a=r(997);let l=(0,o.createContext)(),i=({children:e})=>{let{0:t,1:r}=(0,o.useState)(null),{0:i,1:c}=(0,o.useState)(!0),u=(0,s.useRouter)(),d=async()=>{try{let e=(0,n.parseCookies)();if(!e.token){r(null),c(!1);return}let t=await fetch("http://localhost:5000/auth/session",{headers:{Authorization:`Bearer ${e.token}`},credentials:"include"});if(t.ok){let e=await t.json();r(e.user)}else(0,n.destroyCookie)(null,"token"),r(null)}catch(e){console.error("Check user error:",e),(0,n.destroyCookie)(null,"token"),r(null)}finally{c(!1)}};(0,o.useEffect)(()=>{d()},[]);let g=async e=>{try{let t=await fetch("http://localhost:5000/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)}),o=await t.json();if(t.ok&&o.token)return(0,n.setCookie)(null,"token",o.token,{maxAge:2592e3,path:"/",secure:!0,sameSite:"lax"}),r(o.user),u.push("/blogging-platform/homepage"),{success:!0};return{success:!1,message:o.message}}catch(e){return console.error("Login error:",e),{success:!1,message:"Login failed"}}},h=async()=>{try{await fetch("http://localhost:5000/auth/logout",{method:"POST",credentials:"include"})}catch(e){console.error("Logout error:",e)}finally{(0,n.destroyCookie)(null,"token"),r(null),u.push("/login")}},p=async e=>{try{let t=(0,n.parseCookies)(),o=await fetch("http://localhost:5000/user/update",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.token}`},credentials:"include",body:JSON.stringify(e)}),s=await o.json();if(o.ok)return r(s.user),s.token&&(0,n.setCookie)(null,"token",s.token,{maxAge:2592e3,path:"/",secure:!0,sameSite:"strict"}),{success:!0,message:"Profile updated successfully"};return{success:!1,message:s.message||"Update failed"}}catch(e){return console.error("Profile update error:",e),{success:!1,message:"An error occurred while updating profile"}}};return(0,a.jsx)(l.Provider,{value:{user:t,login:g,logout:h,loading:i,updateUser:p},children:e})},c=()=>(0,o.useContext)(l)},4008:(e,t,r)=>{"use strict";r.d(t,{L:()=>u,U:()=>d});var o=r(6689),s=r(1163),n=r(4410),a=r(997);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){var o,s;o=t,s=r[t],(o=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(o))in e?Object.defineProperty(e,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[o]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let c=(0,o.createContext)(),u=({children:e})=>{let{0:t,1:r}=(0,o.useState)([]),l=(0,s.useRouter)(),{user:u}=(0,n.a)(),d=async()=>{try{let e=await fetch("http://localhost:5000/blogs",{credentials:"include"});if(e.ok){let t=await e.json();r(t)}else r([])}catch(e){console.error("Fetch blogs error:",e)}};(0,o.useEffect)(()=>{!(l.pathname.includes("/login")||l.pathname.includes("/register"))&&u&&d()},[u,l.pathname]);let g=async e=>{try{let o=await fetch("http://localhost:5000/blogs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(o.ok){let e=await o.json();return r([...t,e]),{success:!0}}}catch(e){return console.error("Create blog error:",e),{success:!1}}},h=async(e,o)=>{try{let s=await fetch(`http://localhost:5000/blogs/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)});if(s.ok){let o=await s.json();return r(t.map(t=>t.id===e?o:t)),{success:!0}}}catch(e){return console.error("Update blog error:",e),{success:!1}}},p=async e=>{try{if((await fetch(`http://localhost:5000/blogs/${e}`,{method:"DELETE",credentials:"include"})).ok)return r(t=>t.filter(t=>t.id!==e)),{success:!0}}catch(e){return console.error("Delete blog error:",e),{success:!1}}};return(0,a.jsx)(c.Provider,{value:{blogs:t,createBlog:g,updateBlog:h,deleteBlog:p,updateBlogLikes:(e,t,o)=>{r(r=>Array.isArray(r)?r.map(r=>r.id===e?i(i({},r),{},{likeCount:t,isLiked:o}):r):(console.error("prevBlogs is not an array:",r),[]))},updateBlogComments:(e,t)=>{r(r=>r.map(r=>r.id===e?i(i({},r),{},{comments:t}):r))}},children:e})},d=()=>(0,o.useContext)(c)},5118:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var o=r(4410),s=r(4008),n=r(1163),a=r(3053),l=r(6689);r(108);var i=r(997);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){var o,s;o=t,s=r[t],(o=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(o))in e?Object.defineProperty(e,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[o]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d({Component:e,pageProps:t}){let r=(0,n.useRouter)(),c=["/blogging-platform/login","/blogging-platform/register"].includes(r.pathname);return(0,l.useEffect)(()=>{let e=!!(0,a.parseCookies)().token;if(console.log(e,"isAuthenticated"),console.log(c,"isAuthRoute"),console.log(r.pathname,"router.pathname"),e&&c){r.push("/blogging-platform/homepage");return}if(!e&&!c&&"/"!==r.pathname){r.push("/blogging-platform/login");return}},[r.pathname,c,r]),(0,i.jsx)(o.H,{children:c?(0,i.jsx)(e,u({},t)):(0,i.jsx)(s.L,{children:(0,i.jsx)(e,u({},t))})})}d.getInitialProps=async({Component:e,ctx:t})=>{let r={},o=!!(0,a.parseCookies)(t).token;return e.getInitialProps&&(r=await e.getInitialProps(t)),{pageProps:r,isAuthenticated:o}}},5571:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var o=r(6859),s=r(997);function n(){return(0,s.jsxs)(o.Html,{lang:"en",children:[(0,s.jsx)(o.Head,{}),(0,s.jsxs)("body",{className:"antialiased",children:[(0,s.jsx)(o.Main,{}),(0,s.jsx)(o.NextScript,{})]})]})}},5846:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});class o{constructor(){if(o.instance)return o.instance;this.baseUrl="http://localhost:5000/blogs",o.instance=this}async fetchComments(e){try{let t=await fetch(`${this.baseUrl}/${e}/comments`,{credentials:"include"});if(!t.ok)throw Error("Failed to fetch comments");return t.json()}catch(e){return{success:!1,message:"Unable to load comments. Please try again later."}}}async checkIfLiked(e){try{let t=await fetch(`${this.baseUrl}/${e}/check-like`,{credentials:"include"});if(!t.ok)throw Error("Failed to check like status");return t.json()}catch(e){return{success:!1,message:"Unable to check like status. Please try again later."}}}async likeBlog(e){try{let t=await fetch(`${this.baseUrl}/${e}/like`,{method:"POST",credentials:"include"});if(!t.ok)throw Error("Failed to like blog");return t.json()}catch(e){return{success:!1,message:"Unable to like the blog. Please try again later."}}}async deleteBlog(e){try{let t=await fetch(`${this.baseUrl}/${e}`,{method:"DELETE",credentials:"include"});if(!t.ok)throw Error("Failed to delete blog");return t.json()}catch(e){return{success:!1,message:"Unable to delete the blog. Please try again later."}}}async addComment(e,t){try{let r=await fetch(`${this.baseUrl}/${e}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({content:t})});if(!r.ok)throw Error("Failed to add comment");return r.json()}catch(e){return{success:!1,message:"Unable to add comment. Please try again later."}}}async fetchBlogDetails(e){try{let t=await fetch(`${this.baseUrl}/blog_id/${e}`,{credentials:"include"});if(!t.ok){if(404===t.status)return{success:!1,message:"Blog not found"};throw Error("Failed to fetch blog")}let r=await t.json(),[o,s]=await Promise.all([this.fetchComments(e),this.checkIfLiked(e)]);return{success:!0,blog:r,comments:o,liked:s.liked,likeCount:s.like_count}}catch(e){return{success:!1,message:"Unable to load blog details. Please try again later."}}}}let s=new o},1323:(e,t)=>{"use strict";Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},4609:e=>{e.exports={modalContent:"BlogDetails_modalContent__OVMbs",closeButton:"BlogDetails_closeButton__JySAz",blogContent:"BlogDetails_blogContent__MnvkQ",blogHeader:"BlogDetails_blogHeader__ldH5g",title:"BlogDetails_title__bnMI0",metadata:"BlogDetails_metadata__XENsh",content:"BlogDetails_content__LH86_",interactions:"BlogDetails_interactions__v6zJ0",likeButton:"BlogDetails_likeButton__JNCWp",commentsSection:"BlogDetails_commentsSection__2LO46",commentForm:"BlogDetails_commentForm__vNcVS",commentInput:"BlogDetails_commentInput__LocND",submit:"BlogDetails_submit__8fp62",commentsList:"BlogDetails_commentsList__h8CSv",comment:"BlogDetails_comment__QZUBq",commentHeader:"BlogDetails_commentHeader__wyA0B",commentAuthor:"BlogDetails_commentAuthor__6Oi9Z",commentDate:"BlogDetails_commentDate__7bX1A",popup:"BlogDetails_popup__iAEyM"}},288:e=>{e.exports={container:"EditBlog_container__3JzRT",title:"EditBlog_title__lTLoJ",form:"EditBlog_form__gDT5d",input:"EditBlog_input__IbFBs",textarea:"EditBlog_textarea__kaXv6",buttons:"EditBlog_buttons__sC0r0",submitButton:"EditBlog_submitButton__TduPE",cancelButton:"EditBlog_cancelButton__NJQBc"}},8219:e=>{e.exports={loadingContainer:"Loading_loadingContainer__s3hPe",spinner:"Loading_spinner__uD5wj",spin:"Loading_spin__p6qET"}},5359:(e,t,r)=>{"use strict";r.r(t),r.d(t,{config:()=>B,default:()=>v,getServerSideProps:()=>S,getStaticPaths:()=>x,getStaticProps:()=>k,reportWebVitals:()=>w,routeModule:()=>N,unstable_getServerProps:()=>D,unstable_getServerSideProps:()=>A,unstable_getStaticParams:()=>C,unstable_getStaticPaths:()=>E,unstable_getStaticProps:()=>O});var o={};r.r(o),r.d(o,{default:()=>P});var s=r(5872),n=r(3593),a=r(1323),l=r(5571),i=r(5118),c=r(6689),u=r(1163),d=r(4008),g=r(4410),h=r(288),p=r.n(h),m=r(997);let f=({blog:e})=>{let t=(0,u.useRouter)(),{id:r}=t.query,{updateBlog:o}=(0,d.U)(),{user:s}=(0,g.a)(),{0:n,1:a}=(0,c.useState)(e.title),{0:l,1:i}=(0,c.useState)(e.content);(0,c.useEffect)(()=>{e&&s&&e.user_id!==s.id&&t.push("/blogging-platform/homepage")},[e,s,t]);let h=async e=>{e.preventDefault();try{await o(r,{title:n,content:l}),t.push("/blogging-platform/homepage")}catch(e){console.error("Error updating blog:",e)}};return(0,m.jsx)("div",{className:p().container,children:(0,m.jsxs)("form",{onSubmit:h,className:p().form,children:[(0,m.jsx)("input",{type:"text",value:n,onChange:e=>a(e.target.value),placeholder:"Blog title",className:p().input}),(0,m.jsx)("textarea",{value:l,onChange:e=>i(e.target.value),placeholder:"Blog content",className:p().textarea,rows:"10"}),(0,m.jsxs)("div",{className:p().buttons,children:[(0,m.jsx)("button",{type:"submit",className:p().submitButton,children:"Save Changes"}),(0,m.jsx)("button",{type:"button",onClick:()=>t.push("/blogging-platform/homepage"),className:p().cancelButton,children:"Cancel"})]})]})})};var b=r(3961),y=r(4609),_=r.n(y),j=r(5846);let P=()=>{let e=(0,u.useRouter)(),{id:t}=e.query,{0:r,1:o}=(0,c.useState)(null),{0:s,1:n}=(0,c.useState)(!0),{0:a,1:l}=(0,c.useState)(null);return((0,c.useEffect)(()=>{(async()=>{if(t){n(!0),l(null);try{let e=await j.Z.fetchBlogDetails(t);o(e.blog)}catch(t){console.error("Error fetching blog details:",t),l("Failed to load blog details. Redirecting to homepage..."),setTimeout(()=>{e.push("/blogging-platform/homepage")},1e3)}finally{n(!1)}}})()},[t,e]),s)?(0,m.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,m.jsx)(b.Z,{})}):a?(0,m.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,m.jsx)("h2",{children:a})}):r?(0,m.jsx)("div",{className:"blog-detail-page",children:(0,m.jsxs)("div",{className:_().modalContent,children:[(0,m.jsxs)("div",{className:_().header,children:[(0,m.jsxs)("div",{className:_().blogHeader,children:[(0,m.jsx)("h1",{className:_().title,children:r.title})," "]}),(0,m.jsx)("button",{className:_().closeButton,onClick:()=>{e.push("/blogging-platform/homepage")},children:"\xd7"})]}),(0,m.jsx)(f,{blog:r})]})}):(0,m.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:"Blog not found"})},v=(0,a.l)(o,"default"),k=(0,a.l)(o,"getStaticProps"),x=(0,a.l)(o,"getStaticPaths"),S=(0,a.l)(o,"getServerSideProps"),B=(0,a.l)(o,"config"),w=(0,a.l)(o,"reportWebVitals"),O=(0,a.l)(o,"unstable_getStaticProps"),E=(0,a.l)(o,"unstable_getStaticPaths"),C=(0,a.l)(o,"unstable_getStaticParams"),D=(0,a.l)(o,"unstable_getServerProps"),A=(0,a.l)(o,"unstable_getServerSideProps"),N=new s.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/edit-blog/[id]",pathname:"/edit-blog/[id]",bundlePath:"",filename:""},components:{App:i.default,Document:l.default},userland:o})},108:()=>{},3593:(e,t)=>{"use strict";var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE"}(r||(r={}))},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},3053:e=>{"use strict";e.exports=require("nookies")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[202,163,859],()=>r(5359));module.exports=o})();
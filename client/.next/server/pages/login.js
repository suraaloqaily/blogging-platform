(()=>{var e={};e.id=459,e.ids=[459,660,888],e.modules={3961:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(8219),n=r.n(s),o=r(997);let a=()=>(0,o.jsx)("div",{className:n().loadingContainer,children:(0,o.jsx)("div",{className:n().spinner})})},4410:(e,t,r)=>{"use strict";r.d(t,{H:()=>c,a:()=>l});var s=r(6689),n=r(1163),o=r(3053),a=r(997);let i=(0,s.createContext)(),c=({children:e})=>{let{0:t,1:r}=(0,s.useState)(null),{0:c,1:l}=(0,s.useState)(!0),u=(0,n.useRouter)(),p=async()=>{try{let e=(0,o.parseCookies)();if(!e.token){r(null),l(!1);return}let t=await fetch("http://localhost:5000/auth/session",{headers:{Authorization:`Bearer ${e.token}`},credentials:"include"});if(t.ok){let e=await t.json();r(e.user)}else(0,o.destroyCookie)(null,"token"),r(null)}catch(e){console.error("Check user error:",e),(0,o.destroyCookie)(null,"token"),r(null)}finally{l(!1)}};(0,s.useEffect)(()=>{p()},[]);let d=async e=>{try{let t=await fetch("http://localhost:5000/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)}),s=await t.json();if(t.ok&&s.token)return(0,o.setCookie)(null,"token",s.token,{maxAge:2592e3,path:"/",secure:!0,sameSite:"lax"}),r(s.user),u.push("/homepage"),{success:!0};return{success:!1,message:s.message}}catch(e){return console.error("Login error:",e),{success:!1,message:"Login failed"}}},h=async()=>{try{await fetch("http://localhost:5000/auth/logout",{method:"POST",credentials:"include"})}catch(e){console.error("Logout error:",e)}finally{(0,o.destroyCookie)(null,"token"),r(null),u.push("/login")}},g=async e=>{try{let t=(0,o.parseCookies)(),s=await fetch("http://localhost:5000/user/update",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.token}`},credentials:"include",body:JSON.stringify(e)}),n=await s.json();if(s.ok)return r(n.user),n.token&&(0,o.setCookie)(null,"token",n.token,{maxAge:2592e3,path:"/",secure:!0,sameSite:"strict"}),{success:!0,message:"Profile updated successfully"};return{success:!1,message:n.message||"Update failed"}}catch(e){return console.error("Profile update error:",e),{success:!1,message:"An error occurred while updating profile"}}};return(0,a.jsx)(i.Provider,{value:{user:t,login:d,logout:h,loading:c,updateUser:g},children:e})},l=()=>(0,s.useContext)(i)},4008:(e,t,r)=>{"use strict";r.d(t,{L:()=>u,U:()=>p});var s=r(6689),n=r(1163),o=r(4410),a=r(997);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){var s,n;s=t,n=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s))in e?Object.defineProperty(e,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[s]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let l=(0,s.createContext)(),u=({children:e})=>{let{0:t,1:r}=(0,s.useState)([]),i=(0,n.useRouter)(),{user:u}=(0,o.a)(),p=async()=>{try{let e=await fetch("http://localhost:5000/blogs",{credentials:"include"});if(e.ok){let t=await e.json();r(t)}else r([])}catch(e){console.error("Fetch blogs error:",e)}};(0,s.useEffect)(()=>{!(i.pathname.includes("/login")||i.pathname.includes("/register"))&&u&&p()},[u,i.pathname]);let d=async e=>{try{let s=await fetch("http://localhost:5000/blogs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(s.ok){let e=await s.json();return r([...t,e]),{success:!0}}}catch(e){return console.error("Create blog error:",e),{success:!1}}},h=async(e,s)=>{try{let n=await fetch(`http://localhost:5000/blogs/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)});if(n.ok){let s=await n.json();return r(t.map(t=>t.id===e?s:t)),{success:!0}}}catch(e){return console.error("Update blog error:",e),{success:!1}}},g=async e=>{try{if((await fetch(`http://localhost:5000/blogs/${e}`,{method:"DELETE",credentials:"include"})).ok)return r(t=>t.filter(t=>t.id!==e)),{success:!0}}catch(e){return console.error("Delete blog error:",e),{success:!1}}};return(0,a.jsx)(l.Provider,{value:{blogs:t,createBlog:d,updateBlog:h,deleteBlog:g,updateBlogLikes:(e,t,s)=>{r(r=>Array.isArray(r)?r.map(r=>r.id===e?c(c({},r),{},{likeCount:t,isLiked:s}):r):(console.error("prevBlogs is not an array:",r),[]))},updateBlogComments:(e,t)=>{r(r=>r.map(r=>r.id===e?c(c({},r),{},{comments:t}):r))}},children:e})},p=()=>(0,s.useContext)(l)},5118:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var s=r(4410),n=r(4008),o=r(1163),a=r(3053),i=r(6689);r(108);var c=r(997);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){var s,n;s=t,n=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s))in e?Object.defineProperty(e,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[s]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function p({Component:e,pageProps:t}){let r=(0,o.useRouter)(),l=["/login","/register"].includes(r.pathname);return(0,i.useEffect)(()=>{let e=!!(0,a.parseCookies)().token;if(console.log(e,"isAuthenticated"),console.log(l,"isAuthRoute"),console.log(r.pathname,"router.pathname"),e&&l){r.push("/homepage");return}if(!e&&!l&&"/"!==r.pathname){r.push("/login");return}},[r.pathname,l,r]),(0,c.jsx)(s.H,{children:l?(0,c.jsx)(e,u({},t)):(0,c.jsx)(n.L,{children:(0,c.jsx)(e,u({},t))})})}p.getInitialProps=async({Component:e,ctx:t})=>{let r={},s=!!(0,a.parseCookies)(t).token;return e.getInitialProps&&(r=await e.getInitialProps(t)),{pageProps:r,isAuthenticated:s}}},5571:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(6859),n=r(997);function o(){return(0,n.jsxs)(s.Html,{lang:"en",children:[(0,n.jsx)(s.Head,{}),(0,n.jsxs)("body",{className:"antialiased",children:[(0,n.jsx)(s.Main,{}),(0,n.jsx)(s.NextScript,{})]})]})}},7997:e=>{e.exports={authContainer:"Auth_authContainer__0wNzO",authForm:"Auth_authForm__N9OOO",error:"Auth_error__tYrBg",authWrapper:"Auth_authWrapper__k3dtE",authNav:"Auth_authNav__S96jX",activeNav:"Auth_activeNav__YQdQa",inactiveNav:"Auth_inactiveNav__3Zlm_",switchText:"Auth_switchText__qRVCS",successContainer:"Auth_successContainer__kwKjg",successIcon:"Auth_successIcon__qvYzK",buttonLoading:"Auth_buttonLoading__tYgch",loadingContainer:"Auth_loadingContainer__OJT4x",spinner:"Auth_spinner__3mepE"}},8219:e=>{e.exports={loadingContainer:"Loading_loadingContainer__s3hPe",spinner:"Loading_spinner__uD5wj",spin:"Loading_spin__p6qET"}},6645:(e,t,r)=>{"use strict";r.r(t),r.d(t,{config:()=>S,default:()=>P,getServerSideProps:()=>x,getStaticPaths:()=>w,getStaticProps:()=>_,reportWebVitals:()=>k,routeModule:()=>T,unstable_getServerProps:()=>E,unstable_getServerSideProps:()=>D,unstable_getStaticParams:()=>A,unstable_getStaticPaths:()=>N,unstable_getStaticProps:()=>C});var s={};r.r(s),r.d(s,{default:()=>O});var n=r(5872),o=r(3593),a=r(1323),i=r(5571),c=r(5118),l=r(6689),u=r(4410),p=r(1163),d=r(3961),h=r(1664),g=r.n(h),f=r(7997),m=r.n(f),b=r(997);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach(function(t){var s,n;s=t,n=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s))in e?Object.defineProperty(e,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[s]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function j(){let{0:e,1:t}=(0,l.useState)({email:"",password:""}),{0:r,1:s}=(0,l.useState)(""),{login:n}=(0,u.a)(),o=async t=>{t.preventDefault();let r=await n(e);r.success||s(r.message)};return(0,b.jsx)("div",{className:m().authContainer,children:(0,b.jsxs)("div",{className:m().authWrapper,children:[(0,b.jsxs)("div",{className:m().authNav,children:[(0,b.jsx)(g(),{href:"/login",className:m().activeNav,children:"Login"}),(0,b.jsx)(g(),{href:"/register",className:m().inactiveNav,children:"Register"})]}),(0,b.jsxs)("form",{onSubmit:o,className:m().authForm,children:[r&&(0,b.jsx)("div",{className:m().error,children:r}),(0,b.jsx)("input",{type:"email",autoComplete:"email",placeholder:"Email",value:e.email,onChange:r=>t(v(v({},e),{},{email:r.target.value}))}),(0,b.jsx)("input",{type:"password",autoComplete:"password",placeholder:"Password",value:e.password,onChange:r=>t(v(v({},e),{},{password:r.target.value}))}),(0,b.jsx)("button",{type:"submit",children:"Login"}),(0,b.jsxs)("p",{className:m().switchText,children:["Do not have an account? ",(0,b.jsx)(g(),{href:"/register",children:"Register here "})]})]})]})})}let O=()=>{let{user:e,loading:t}=(0,u.a)(),r=(0,p.useRouter)();return((0,l.useEffect)(()=>{e&&r.push("/homepage")},[e,r]),t)?(0,b.jsx)(d.Z,{}):e?null:(0,b.jsx)(j,{})},P=(0,a.l)(s,"default"),_=(0,a.l)(s,"getStaticProps"),w=(0,a.l)(s,"getStaticPaths"),x=(0,a.l)(s,"getServerSideProps"),S=(0,a.l)(s,"config"),k=(0,a.l)(s,"reportWebVitals"),C=(0,a.l)(s,"unstable_getStaticProps"),N=(0,a.l)(s,"unstable_getStaticPaths"),A=(0,a.l)(s,"unstable_getStaticParams"),E=(0,a.l)(s,"unstable_getServerProps"),D=(0,a.l)(s,"unstable_getServerSideProps"),T=new n.PagesRouteModule({definition:{kind:o.x.PAGES,page:"/login",pathname:"/login",bundlePath:"",filename:""},components:{App:c.default,Document:i.default},userland:s})},108:()=>{},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},3053:e=>{"use strict";e.exports=require("nookies")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[202,163,859,291],()=>r(6645));module.exports=s})();
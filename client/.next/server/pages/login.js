(()=>{var e={};e.id=459,e.ids=[459,888,660],e.modules={3961:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var o=r(8219),s=r.n(o),n=r(997);let a=()=>(0,n.jsx)("div",{className:s().loadingContainer,children:(0,n.jsx)("div",{className:s().spinner})})},4410:(e,t,r)=>{"use strict";r.d(t,{H:()=>l,a:()=>c});var o=r(6689),s=r(1163),n=r(3053),a=r(997);let i=(0,o.createContext)(),l=({children:e})=>{let{0:t,1:r}=(0,o.useState)(null),{0:l,1:c}=(0,o.useState)(!0),u=(0,s.useRouter)(),p=async()=>{try{let e=(0,n.parseCookies)();if(!e.token){r(null),c(!1);return}let t=await fetch("http://localhost:5000/auth/session",{headers:{Authorization:`Bearer ${e.token}`},credentials:"include"});if(t.ok){let e=await t.json();r(e.user)}else(0,n.destroyCookie)(null,"token"),r(null)}catch(e){console.error("Check user error:",e),(0,n.destroyCookie)(null,"token"),r(null)}finally{c(!1)}};(0,o.useEffect)(()=>{p()},[]);let g=async e=>{try{let t=await fetch("http://localhost:5000/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)}),o=await t.json();if(t.ok&&o.token)return(0,n.setCookie)(null,"token",o.token,{maxAge:2592e3,path:"/",secure:!0,sameSite:"lax"}),r(o.user),u.push("/blogging-platform/homepage"),{success:!0};return{success:!1,message:o.message}}catch(e){return console.error("Login error:",e),{success:!1,message:"Login failed"}}},d=async()=>{try{await fetch("http://localhost:5000/auth/logout",{method:"POST",credentials:"include"})}catch(e){console.error("Logout error:",e)}finally{(0,n.destroyCookie)(null,"token"),r(null),u.push("/login")}},h=async e=>{try{let t=(0,n.parseCookies)(),o=await fetch("http://localhost:5000/user/update",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.token}`},credentials:"include",body:JSON.stringify(e)}),s=await o.json();if(o.ok)return r(s.user),s.token&&(0,n.setCookie)(null,"token",s.token,{maxAge:2592e3,path:"/",secure:!0,sameSite:"strict"}),{success:!0,message:"Profile updated successfully"};return{success:!1,message:s.message||"Update failed"}}catch(e){return console.error("Profile update error:",e),{success:!1,message:"An error occurred while updating profile"}}};return(0,a.jsx)(i.Provider,{value:{user:t,login:g,logout:d,loading:l,updateUser:h},children:e})},c=()=>(0,o.useContext)(i)},4008:(e,t,r)=>{"use strict";r.d(t,{L:()=>u,U:()=>p});var o=r(6689),s=r(1163),n=r(4410),a=r(997);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){var o,s;o=t,s=r[t],(o=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(o))in e?Object.defineProperty(e,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[o]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let c=(0,o.createContext)(),u=({children:e})=>{let{0:t,1:r}=(0,o.useState)([]),i=(0,s.useRouter)(),{user:u}=(0,n.a)(),p=async()=>{try{let e=await fetch("http://localhost:5000/blogs",{credentials:"include"});if(e.ok){let t=await e.json();r(t)}else r([])}catch(e){console.error("Fetch blogs error:",e)}};(0,o.useEffect)(()=>{!(i.pathname.includes("/login")||i.pathname.includes("/register"))&&u&&p()},[u,i.pathname]);let g=async e=>{try{let o=await fetch("http://localhost:5000/blogs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(o.ok){let e=await o.json();return r([...t,e]),{success:!0}}}catch(e){return console.error("Create blog error:",e),{success:!1}}},d=async(e,o)=>{try{let s=await fetch(`http://localhost:5000/blogs/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)});if(s.ok){let o=await s.json();return r(t.map(t=>t.id===e?o:t)),{success:!0}}}catch(e){return console.error("Update blog error:",e),{success:!1}}},h=async e=>{try{if((await fetch(`http://localhost:5000/blogs/${e}`,{method:"DELETE",credentials:"include"})).ok)return r(t=>t.filter(t=>t.id!==e)),{success:!0}}catch(e){return console.error("Delete blog error:",e),{success:!1}}};return(0,a.jsx)(c.Provider,{value:{blogs:t,createBlog:g,updateBlog:d,deleteBlog:h,updateBlogLikes:(e,t,o)=>{r(r=>Array.isArray(r)?r.map(r=>r.id===e?l(l({},r),{},{likeCount:t,isLiked:o}):r):(console.error("prevBlogs is not an array:",r),[]))},updateBlogComments:(e,t)=>{r(r=>r.map(r=>r.id===e?l(l({},r),{},{comments:t}):r))}},children:e})},p=()=>(0,o.useContext)(c)},5118:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var o=r(4410),s=r(4008),n=r(1163),a=r(3053),i=r(6689);r(108);var l=r(997);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){var o,s;o=t,s=r[t],(o=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(o))in e?Object.defineProperty(e,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[o]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function p({Component:e,pageProps:t}){let r=(0,n.useRouter)(),c=["/blogging-platform/login","/blogging-platform/register"].includes(r.pathname);return(0,i.useEffect)(()=>{let e=!!(0,a.parseCookies)().token;if(console.log(e,"isAuthenticated"),console.log(c,"isAuthRoute"),console.log(r.pathname,"router.pathname"),e&&c){r.push("/blogging-platform/homepage");return}if(!e&&!c&&"/"!==r.pathname){r.push("/blogging-platform/login");return}},[r.pathname,c,r]),(0,l.jsx)(o.H,{children:c?(0,l.jsx)(e,u({},t)):(0,l.jsx)(s.L,{children:(0,l.jsx)(e,u({},t))})})}p.getInitialProps=async({Component:e,ctx:t})=>{let r={},o=!!(0,a.parseCookies)(t).token;return e.getInitialProps&&(r=await e.getInitialProps(t)),{pageProps:r,isAuthenticated:o}}},5571:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var o=r(6859),s=r(997);function n(){return(0,s.jsxs)(o.Html,{lang:"en",children:[(0,s.jsx)(o.Head,{}),(0,s.jsxs)("body",{className:"antialiased",children:[(0,s.jsx)(o.Main,{}),(0,s.jsx)(o.NextScript,{})]})]})}},7997:e=>{e.exports={authContainer:"Auth_authContainer__0wNzO",authForm:"Auth_authForm__N9OOO",error:"Auth_error__tYrBg",authWrapper:"Auth_authWrapper__k3dtE",authNav:"Auth_authNav__S96jX",activeNav:"Auth_activeNav__YQdQa",inactiveNav:"Auth_inactiveNav__3Zlm_",switchText:"Auth_switchText__qRVCS",successContainer:"Auth_successContainer__kwKjg",successIcon:"Auth_successIcon__qvYzK",buttonLoading:"Auth_buttonLoading__tYgch",loadingContainer:"Auth_loadingContainer__OJT4x",spinner:"Auth_spinner__3mepE"}},8219:e=>{e.exports={loadingContainer:"Loading_loadingContainer__s3hPe",spinner:"Loading_spinner__uD5wj",spin:"Loading_spin__p6qET"}},6645:(e,t,r)=>{"use strict";r.r(t),r.d(t,{config:()=>S,default:()=>P,getServerSideProps:()=>x,getStaticPaths:()=>w,getStaticProps:()=>_,reportWebVitals:()=>k,routeModule:()=>T,unstable_getServerProps:()=>E,unstable_getServerSideProps:()=>D,unstable_getStaticParams:()=>A,unstable_getStaticPaths:()=>N,unstable_getStaticProps:()=>C});var o={};r.r(o),r.d(o,{default:()=>O});var s=r(5872),n=r(3593),a=r(1323),i=r(5571),l=r(5118),c=r(6689),u=r(4410),p=r(1163),g=r(3961),d=r(1664),h=r.n(d),f=r(7997),m=r.n(f),b=r(997);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach(function(t){var o,s;o=t,s=r[t],(o=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(o))in e?Object.defineProperty(e,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[o]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function j(){let{0:e,1:t}=(0,c.useState)({email:"",password:""}),{0:r,1:o}=(0,c.useState)(""),{login:s}=(0,u.a)(),n=async t=>{t.preventDefault();let r=await s(e);r.success||o(r.message)};return(0,b.jsx)("div",{className:m().authContainer,children:(0,b.jsxs)("div",{className:m().authWrapper,children:[(0,b.jsxs)("div",{className:m().authNav,children:[(0,b.jsx)(h(),{href:"/blogging-platform/login",className:m().activeNav,children:"Login"}),(0,b.jsx)(h(),{href:"/blogging-platform/register",className:m().inactiveNav,children:"Register"})]}),(0,b.jsxs)("form",{onSubmit:n,className:m().authForm,children:[r&&(0,b.jsx)("div",{className:m().error,children:r}),(0,b.jsx)("input",{type:"email",autoComplete:"email",placeholder:"Email",value:e.email,onChange:r=>t(v(v({},e),{},{email:r.target.value}))}),(0,b.jsx)("input",{type:"password",autoComplete:"password",placeholder:"Password",value:e.password,onChange:r=>t(v(v({},e),{},{password:r.target.value}))}),(0,b.jsx)("button",{type:"submit",children:"Login"}),(0,b.jsxs)("p",{className:m().switchText,children:["Do not have an account? ",(0,b.jsx)(h(),{href:"/register",children:"Register here "})]})]})]})})}let O=()=>{let{user:e,loading:t}=(0,u.a)(),r=(0,p.useRouter)();return((0,c.useEffect)(()=>{e&&r.push("/blogging-platform/homepage")},[e,r]),t)?(0,b.jsx)(g.Z,{}):e?null:(0,b.jsx)(j,{})},P=(0,a.l)(o,"default"),_=(0,a.l)(o,"getStaticProps"),w=(0,a.l)(o,"getStaticPaths"),x=(0,a.l)(o,"getServerSideProps"),S=(0,a.l)(o,"config"),k=(0,a.l)(o,"reportWebVitals"),C=(0,a.l)(o,"unstable_getStaticProps"),N=(0,a.l)(o,"unstable_getStaticPaths"),A=(0,a.l)(o,"unstable_getStaticParams"),E=(0,a.l)(o,"unstable_getServerProps"),D=(0,a.l)(o,"unstable_getServerSideProps"),T=new s.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/login",pathname:"/login",bundlePath:"",filename:""},components:{App:l.default,Document:i.default},userland:o})},108:()=>{},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},3053:e=>{"use strict";e.exports=require("nookies")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[202,163,859,291],()=>r(6645));module.exports=o})();